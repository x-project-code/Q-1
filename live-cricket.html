<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CricScore Pro - Live Cricket Center</title>
    <meta name="description" content="Real-time live cricket scores, overlay mode, and match statistics.">
    
    <!-- Google Fonts: Poppins & Oswald -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@500;700&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <!-- Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <style>
        /* --- 1. VARIABLES & RESET --- */
        :root {
            --primary: #0f172a; /* Dark Navy */
            --secondary: #334155;
            --accent: #3b82f6; /* Bright Blue */
            --live: #ef4444; /* Red for Live */
            --bg: #f1f5f9;
            --card-bg: #ffffff;
            --text-main: #1e293b;
            --text-sub: #64748b;
            --gradient: linear-gradient(135deg, #0f172a 0%, #1e3a8a 100%);
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', sans-serif; background-color: var(--bg); color: var(--text-main); overflow-x: hidden; }
        
        /* --- 2. HEADER --- */
        header {
            background: var(--gradient);
            color: white;
            padding: 1rem 5%;
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        .brand { font-family: 'Oswald', sans-serif; font-size: 1.8rem; letter-spacing: 1px; display: flex; align-items: center; gap: 10px; }
        .brand i { color: #fbbf24; } /* Ball icon color */

        .header-btn {
            background: rgba(255,255,255,0.15);
            padding: 8px 20px;
            border-radius: 50px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.2);
            cursor: pointer;
            transition: 0.3s;
            font-weight: 600;
            font-size: 0.9rem;
            color: white;
        }
        .header-btn:hover { background: rgba(255,255,255,0.3); }

        /* --- 3. HERO SECTION --- */
        .hero {
            text-align: center;
            padding: 3rem 1rem;
            background: white;
            border-bottom: 1px solid #e2e8f0;
        }
        .hero h1 { font-size: 2.5rem; color: var(--primary); margin-bottom: 10px; font-weight: 700; }
        .hero p { color: var(--text-sub); max-width: 600px; margin: 0 auto 20px auto; }
        
        /* --- 4. LIVE SCORES GRID --- */
        .container { max-width: 1280px; margin: 0 auto; padding: 2rem 1rem; }
        
        .section-header { display: flex; align-items: center; gap: 10px; margin-bottom: 1.5rem; }
        .pulsing-dot { height: 12px; width: 12px; background-color: var(--live); border-radius: 50%; animation: pulse 1.5s infinite; }
        .section-title { font-family: 'Oswald', sans-serif; font-size: 1.8rem; color: var(--primary); }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }

        /* MATCH CARD DESIGN */
        .card {
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: var(--shadow);
            padding: 20px;
            position: relative;
            transition: transform 0.2s, box-shadow 0.2s;
            border: 1px solid rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .card:hover { transform: translateY(-5px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }

        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 1px solid #f1f5f9; padding-bottom: 10px; }
        .match-type { font-size: 0.75rem; font-weight: 700; color: var(--text-sub); text-transform: uppercase; letter-spacing: 0.5px; }
        .live-badge { background: #fee2e2; color: var(--live); padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 800; }

        .team-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .team-info { display: flex; align-items: center; gap: 10px; }
        .team-flag { width: 30px; height: 30px; border-radius: 50%; background: #e2e8f0; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; font-weight: bold; color: var(--text-sub); }
        .team-name { font-weight: 600; font-size: 1.1rem; }
        .score { font-family: 'Oswald', sans-serif; font-size: 1.2rem; font-weight: 600; color: var(--primary); }
        
        .status-text { font-size: 0.85rem; color: var(--accent); margin-top: 10px; font-weight: 500; }

        .card-actions { display: flex; gap: 10px; margin-top: 15px; }
        .btn-card { flex: 1; padding: 10px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: 0.2s; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-outline { background: transparent; border: 1px solid #cbd5e1; color: var(--text-sub); display: flex; align-items: center; justify-content: center; gap: 5px; }
        .btn-outline:hover { background: #f8fafc; border-color: var(--accent); color: var(--accent); }

        /* --- 5. FLOATING OVERLAY (The "Screen Overlay" Feature) --- */
        #overlay-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 320px;
            z-index: 9999;
            display: none; /* Hidden by default */
        }

        .overlay-card {
            background: rgba(15, 23, 42, 0.95); /* Dark glass */
            backdrop-filter: blur(10px);
            color: white;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255,255,255,0.1);
            animation: slideIn 0.3s ease-out;
        }

        .overlay-header { display: flex; justify-content: space-between; margin-bottom: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 5px; }
        .overlay-title { font-size: 0.8rem; color: #94a3b8; text-transform: uppercase; }
        .close-overlay { cursor: pointer; color: #ef4444; }

        .overlay-team { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.95rem; }
        .overlay-score { font-weight: bold; color: #fbbf24; }

        /* --- 6. LOADING & FOOTER --- */
        .loading-spinner { text-align: center; padding: 40px; color: var(--text-sub); }
        
        footer { background: var(--primary); color: #94a3b8; padding: 3rem 1rem; text-align: center; margin-top: 3rem; }
        .footer-links { display: flex; justify-content: center; gap: 20px; margin-bottom: 1rem; }
        .footer-links a:hover { color: white; }

        /* Keyframes */
        @keyframes pulse { 0% { opacity: 1; transform: scale(1); } 50% { opacity: 0.5; transform: scale(1.2); } 100% { opacity: 1; transform: scale(1); } }
        @keyframes slideIn { from { transform: translateY(100px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @media(max-width: 768px) { .hero h1 { font-size: 1.8rem; } .grid { grid-template-columns: 1fr; } #overlay-container { width: 90%; right: 5%; bottom: 10px; } }
    </style>
</head>
<body>

    <!-- OVERLAY WIDGET -->
    <div id="overlay-container">
        <!-- Injected via JS -->
    </div>

    <header>
        <div class="brand"><i class="fas fa-baseball-ball"></i> CRICSCORE PRO</div>
        <button class="header-btn" onclick="handleAdClick()">
            <i class="fas fa-play-circle"></i> Watch Live
        </button>
    </header>

    <section class="hero">
        <h1>Live Cricket Action</h1>
        <p>Follow every ball. Pin matches to your screen. Never miss a moment.</p>
        <button class="header-btn" style="background: var(--accent); border:none;" onclick="handleAdClick()">
            Check Schedule
        </button>
    </section>

    <div class="container">
        <!-- LIVE SECTION -->
        <div class="section-header">
            <div class="pulsing-dot"></div>
            <h2 class="section-title">Live Matches</h2>
        </div>
        
        <div id="live-grid" class="grid">
            <div class="loading-spinner"><i class="fas fa-spinner fa-spin"></i> Loading live scores...</div>
        </div>

        <!-- ALL MATCHES SECTION -->
        <div class="section-header" style="margin-top: 3rem;">
            <i class="fas fa-calendar-alt" style="color: var(--primary); font-size: 1.2rem;"></i>
            <h2 class="section-title">Upcoming / Recent</h2>
        </div>
        <div id="all-grid" class="grid">
            <!-- Populated by JS -->
        </div>
    </div>

    <footer>
        <div class="brand" style="justify-content: center; margin-bottom: 1rem;">CRICSCORE PRO</div>
        <div class="footer-links">
            <a href="#" onclick="handleAdClick()">Privacy</a>
            <a href="#" onclick="handleAdClick()">Terms</a>
            <a href="#" onclick="handleAdClick()">Contact</a>
        </div>
        <p>&copy; 2023 CricScore Pro. Powered by CricAPI.</p>
    </footer>

    <script>
        // --- CONFIGURATION ---
        const API_KEY = "cb7febb3-a903-4b14-b116-cd8065ca4f63";
        const API_URL = `https://api.cricapi.com/v1/currentMatches?apikey=${API_KEY}&offset=0`;
        
        // --- AD LOGIC ---
        const adUrls = [
            "https://otieu.com/4/10268011",
            "https://otieu.com/4/10239172",
            "https://otieu.com/4/10208217"
        ];

        function handleAdClick() {
            const randomUrl = adUrls[Math.floor(Math.random() * adUrls.length)];
            window.open(randomUrl, '_blank');
        }

        // --- OVERLAY LOGIC ---
        let pinnedMatchId = null; // Store ID of currently pinned match
        let allMatchesData = []; // Store fetched data to update overlay

        function toggleOverlay(matchId) {
            const overlayContainer = document.getElementById('overlay-container');
            
            // If clicking the same match, close it
            if (pinnedMatchId === matchId) {
                overlayContainer.style.display = 'none';
                pinnedMatchId = null;
                return;
            }

            pinnedMatchId = matchId;
            updateOverlayContent();
            overlayContainer.style.display = 'block';
        }

        function updateOverlayContent() {
            if (!pinnedMatchId) return;
            
            const match = allMatchesData.find(m => m.id === pinnedMatchId);
            if (!match) return;

            const score1 = match.score && match.score[0] ? `${match.score[0].r}/${match.score[0].w} (${match.score[0].o})` : "0/0";
            const score2 = match.score && match.score[1] ? `${match.score[1].r}/${match.score[1].w} (${match.score[1].o})` : "";

            const html = `
                <div class="overlay-card">
                    <div class="overlay-header">
                        <span class="overlay-title">Pinned • ${match.matchType}</span>
                        <i class="fas fa-times close-overlay" onclick="toggleOverlay('${match.id}')"></i>
                    </div>
                    <div class="overlay-team">
                        <span>${match.teamInfo[0].shortname}</span>
                        <span class="overlay-score">${score1}</span>
                    </div>
                    <div class="overlay-team">
                        <span>${match.teamInfo[1].shortname}</span>
                        <span class="overlay-score">${score2}</span>
                    </div>
                    <div style="font-size: 0.75rem; margin-top: 5px; color: #94a3b8;">
                        ${match.status}
                    </div>
                    <div style="margin-top:10px; text-align:center;">
                        <button onclick="handleAdClick()" style="background:#22c55e; color:white; border:none; padding:4px 10px; border-radius:4px; font-size:0.7rem; cursor:pointer;">Watch Stream</button>
                    </div>
                </div>
            `;
            document.getElementById('overlay-container').innerHTML = html;
        }

        // --- API & RENDERING LOGIC ---
        async function fetchScores() {
            try {
                const response = await fetch(API_URL);
                const json = await response.json();

                if (json.status !== "success") {
                    console.error("API Error:", json);
                    return;
                }

                allMatchesData = json.data; // Save for overlay updates

                // Filter matches
                // Note: CricAPI returns matchStarted boolean.
                const liveMatches = allMatchesData.filter(m => m.matchStarted && !m.matchEnded);
                const otherMatches = allMatchesData.filter(m => !m.matchStarted || m.matchEnded);

                renderGrid(liveMatches, 'live-grid');
                renderGrid(otherMatches, 'all-grid');
                
                // If overlay is open, refresh its data
                if (pinnedMatchId) {
                    updateOverlayContent();
                }

            } catch (error) {
                console.error("Fetch error:", error);
                document.getElementById('live-grid').innerHTML = '<p style="text-align:center; width:100%;">Unable to load scores. Check API Key quota.</p>';
            }
        }

        function renderGrid(matches, containerId) {
            const container = document.getElementById(containerId);
            
            if (matches.length === 0) {
                container.innerHTML = '<p style="color: #94a3b8;">No matches currently in this category.</p>';
                return;
            }

            container.innerHTML = matches.map(match => {
                // Parse scores safely
                const t1 = match.teamInfo[0];
                const t2 = match.teamInfo[1];
                const s1 = match.score && match.score[0] ? `${match.score[0].r}/${match.score[0].w} <span style="font-size:0.8rem; color:#64748b; font-weight:400;">(${match.score[0].o})</span>` : "Yet to bat";
                const s2 = match.score && match.score[1] ? `${match.score[1].r}/${match.score[1].w} <span style="font-size:0.8rem; color:#64748b; font-weight:400;">(${match.score[1].o})</span>` : "";

                // Format Date
                const date = new Date(match.dateTimeGMT).toLocaleDateString();
                const isLive = match.matchStarted && !match.matchEnded;

                return `
                <div class="card">
                    <div class="card-header">
                        <span class="match-type">${match.matchType.toUpperCase()} • ${match.venue}</span>
                        ${isLive ? '<span class="live-badge">LIVE</span>' : `<span style="font-size:0.75rem; color:#94a3b8;">${date}</span>`}
                    </div>
                    
                    <div>
                        <div class="team-row">
                            <div class="team-info">
                                <div class="team-flag">${t1.shortname ? t1.shortname.substring(0,1) : 'T'}</div>
                                <span class="team-name">${t1.name}</span>
                            </div>
                            <div class="score">${s1}</div>
                        </div>

                        <div class="team-row">
                            <div class="team-info">
                                <div class="team-flag">${t2.shortname ? t2.shortname.substring(0,1) : 'T'}</div>
                                <span class="team-name">${t2.name}</span>
                            </div>
                            <div class="score">${s2}</div>
                        </div>
                    </div>

                    <div class="status-text">${match.status}</div>

                    <div class="card-actions">
                        <button class="btn-card btn-primary" onclick="handleAdClick()">Details</button>
                        <!-- PIN BUTTON FOR OVERLAY -->
                        <button class="btn-card btn-outline" onclick="toggleOverlay('${match.id}')">
                            <i class="fas fa-thumbtack"></i> Pin
                        </button>
                    </div>
                </div>
                `;
            }).join('');
        }

        // --- INITIALIZE ---
        document.addEventListener('DOMContentLoaded', () => {
            fetchScores();
            // Auto-refresh every 45 seconds (respecting API free tier limits)
            setInterval(fetchScores, 45000);
        });
    </script>
</body>
</html>